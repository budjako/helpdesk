<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Chapter 27 MySQL for Excel</title>
<link rel="stylesheet" href="mvl.css" type="text/css" />
<meta name="generator" content="DocBook XSL Stylesheets V1.69.1 + chunker.py v1.9.1" />
<link rel="start" href="index.html" title="{book-title}" />
<link rel="up" href="" title="" />
<link rel="prev" href="workbench.html" title="Chapter 26 MySQL Workbench" />
<link rel="next" href="licenses-third-party.html" title="Appendix A Licenses for Third-Party Components" />
<script language="javascript" type="text/javascript">
  function addOnload(theFunc)
  {
    var previous = window.onload;
    if (typeof window.onload != 'function')
    {
      window.onload = theFunc;
    }
    else
    {
      window.onload = function()
      {
        previous();
        theFunc();
      }
    }
  }

  addOnload(function()
  {
    var base = new Date(1400110574*1000);
    var now = new Date();
    var diff = ((now-base)/1000)/(24*3600);

    if (diff > 90) {
      var nodes = document.getElementsByClassName('titlepage');
      nodes[0].innerHTML = '<p style="border: 5px #ff0000 solid; padding: 5px; margin 5px">' +
        'This copy of the manual is more than 90 days old. We encourage you to download a ' +
        'new version from <a href="http://dev.mysql.com">dev.mysql.com/doc</a>.</p>' + nodes[0].innerHTML;
    }
  });
</script>
<noscript></noscript>
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<th colspan="3" align="center">Chapter 27 MySQL for Excel</th>
</tr>
<tr>
<td width="20%" align="left"><a accesskey="p" href="workbench.html">Prev</a> </td>
<th width="60%" align="center"></th>
<td width="20%" align="right"> <a accesskey="n" href="licenses-third-party.html">Next</a></td>
</tr>
</table>
<hr>
</div>
<div class="chapter">
<div class="titlepage">
<div>
<div>
<h1 class="title"><a name="mysql-for-excel"></a>Chapter 27 MySQL for Excel</h1>

</div>

</div>

</div>
<div class="toc">
<p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="mysql-for-excel.html#mysql-for-excel-install">27.1 Installing and Configuring</a></span></dt><dt><span class="section"><a href="mysql-for-excel.html#mysql-for-excel-edit">27.2 Edit MySQL Data in Excel</a></span></dt><dt><span class="section"><a href="mysql-for-excel.html#mysql-for-excel-import">27.3 Import MySQL Data into Excel</a></span></dt><dt><span class="section"><a href="mysql-for-excel.html#mysql-for-excel-append">27.4 Append Excel Data into MySQL</a></span></dt><dt><span class="section"><a href="mysql-for-excel.html#mysql-for-excel-export">27.5 Export Excel Data into MySQL</a></span></dt><dt><span class="section"><a href="mysql-for-excel.html#mysql-for-excel-what-is-new">27.6 What Is New In MySQL for Excel</a></span></dt><dt><span class="section"><a href="mysql-for-excel.html#mysql-for-excel-faq">27.7 MySQL for Excel FAQ</a></span></dt></dl>
</div>
<p>
    MySQL for Excel enables you to work with a MySQL database from within
    Microsoft Excel. MySQL data can be imported into Excel, Excel data
    can be exported into MySQL as a new table or appended to a current
    table, and MySQL for Excel enables you to edit the MySQL data directly from
    within Excel.
  </p><p>
    Visit the <a class="ulink" href="http://forums.mysql.com/list.php?172" target="_top">MySQL
    for Excel forum</a> for additional MySQL for Excel help and support.
  </p><p>
    For release notes detailing the changes in each release of MySQL for Excel,
    see <a class="ulink" href="http://dev.mysql.com/doc/relnotes/mysql-for-excel/en/" target="_top">MySQL for
    Excel Release Notes</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="mysql-for-excel-install"></a>27.1 Installing and Configuring</h2>
</div>
</div>
</div>
<p>
      MySQL for Excel is a product for Microsoft Windows, and it is installed
      with MySQL Installer. And typically you will not be required to install or
      configure additional tools to use MySQL for Excel.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        To install, download and execute the
        <a class="ulink" href="http://dev.mysql.com/downloads/installer/" target="_top">MySQL Installer</a>. Select
        the MySQL for Excel product and then proceed with the installation. See
        the <a class="link" href="installing.html#mysql-installer" title="2.3.3 Installing MySQL on Microsoft Windows Using MySQL Installer">MySQL Installer manual</a> for
        additional details.
</p>
</div>
<h3><a name="idm47343733515584"></a>MySQL for Excel Requirements</h3>
<p>
      The MySQL Installer installation process will check if these requirements are
      met, or notify you if further action is required before proceeding
      with the installation.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          .NET Framework 4.0 (Client or Full Profile).
        </p></li><li class="listitem"><p>
          Microsoft Office Excel 2007 or greater, for Microsoft Windows.
        </p></li><li class="listitem"><p>
          Visual Studio Tools for Office 4.0, and MySQL Installer may install this
          for you.
        </p></li><li class="listitem"><p>
          An available MySQL Server connection.
</p></li></ul>
</div>
<p>
      MySQL for Excel is loaded and executed by selecting the
      <span class="guimenu">Data</span> menu tab in Excel, and then choosing the
      "MySQL for Excel" Database icon. This opens a new Excel sidebar with the
      available MySQL for Excel options. The navigation bar with the MySQL for Excel
      icon is shown in the following screenshot:
</p>
<div class="figure">
<a name="mysql-for-excel-navigation-bar"></a><p class="title"><b>Figure 27.1 The MySQL for Excel navigation bar</b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="images/mysql-for-excel-home.png" width="842" height="762" alt="The MySQL for Excel navigation bar">
</div>

</div>

</div>
<br class="figure-break">
<h3><a name="idm47343733502304"></a>Configuration</h3>
<p>
      While each action, such as <span class="guilabel">Import MySQL Data</span>,
      has its own set of options, this section describes the global
      options that affect the entire plugin.
</p>
<div class="figure">
<a name="mysql-for-excel-global-options"></a><p class="title"><b>Figure 27.2 The MySQL for Excel configuration: Global Options</b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="images/mysql-for-excel-global-options.png" width="510" height="479" alt="The MySQL for Excel configuration: Global Options">
</div>

</div>

</div>
<br class="figure-break">
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Connection Options:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Wait [ ] seconds for a connection to the server before
              timing out. Defaults to 15.
            </p></li><li class="listitem"><p>
              Wait [ ] seconds for a database query to execute before
              timing out. Defaults to 60.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          SQL Queries Options:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              [ ] Use optimistic updates on all Edit Data sessions.
              Enabled by default.
            </p></li><li class="listitem"><p>
              ( ) Do not show SQL statements sent to the server. Enabled
              by default.
            </p></li><li class="listitem"><p>
              ( ) Preview SQL statements before they are sent to the
              server. Disabled by default.
            </p></li><li class="listitem"><p>
              ( ) Show executed SQL statements along with their results.
              Disabled by default.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          Edit Session Options:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              [ ] Restore saved Edit sessions when opening an Excel
              workbook. Enabled by default.
            </p></li><li class="listitem"><p>
              ( ) Reuse Excel worksheets matching their names with the
              session table names. Enabled by default.
            </p></li><li class="listitem"><p>
              ( ) Create new Excel worksheets for the restored Edit
              sessions. Disabled by default.
</p></li></ul>
</div>
</li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="mysql-for-excel-edit"></a>27.2 Edit MySQL Data in Excel</h2>

</div>

</div>

</div>
<p>
      MySQL for Excel enables you to load and edit MySQL data directly from
      Microsoft Excel. Changes are immediately committed if the
      <span class="guilabel">Auto-Commit</span> option is enabled, or done
      manually by pressing <span class="guibutton">Commit Changes</span>.
    </p><p>
      The example below uses the <code class="literal">category</code> table of
      the example <code class="literal">sakila</code> database, but the screen
      will look the same for any table. Within MySQL for Excel, <span class="guilabel">Open
      a MySQL Connection</span>, click the <code class="literal">sakila</code>
      schema, <span class="guibutton">Next</span>, select the
      <code class="literal">category</code> table, click <span class="guilabel">Edit MySQL
      Data</span>, then choose <span class="guibutton">Import</span> to
      import the data into a new Microsoft Excel worksheet for editing.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        For additional information about the importing procedure, see
        <a class="xref" href="mysql-for-excel.html#mysql-for-excel-import" title="27.3 Import MySQL Data into Excel">Section 27.3, “Import MySQL Data into Excel”</a>.
</p>
</div>

<div class="figure">
<a name="mysql-for-excel-edit-table"></a><p class="title"><b>Figure 27.3 Editing table data with MySQL for Excel</b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="images/excel-plugin-edit-window.png" width="916" height="762" alt="Editing table data with MySQL for Excel">
</div>

</div>

</div>
<br class="figure-break"><p>
      The background color represents the status of each cell, and there
      are four distinct colors that are used while editing table data:
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        The Green and Blue colors were switched in MySQL for Excel 1.2.0.
</p>
</div>

<div class="table">
<a name="idm47343733462256"></a><p class="title"><b>Table 27.1 Background cell colors</b></p>
<div class="table-contents">
<table summary="Background cell colors" border="1"><colgroup><col class="color"><col class="description"></colgroup><thead><tr><th scope="col">Color</th><th scope="col">Description</th></tr></thead><tbody><tr><td bgcolor="#FFFFFF" scope="row">White



</td><td>Default color for all cells. This is either the original data, or the
              data after <span class="guibutton">Refresh from DB</span> is
              clicked.</td></tr><tr><td bgcolor="#7CC576" scope="row">Green



</td><td>Cells that were committed with success.</td></tr><tr><td bgcolor="#B8E5F7" scope="row">Blue



</td><td>Cells that were modified but have not yet been committed.</td></tr><tr><td bgcolor="#FF8282" scope="row">Red



</td><td>Cells that generated an error when a commit was attempted. An error
              dialog is also displayed while the commit is attempted.</td></tr><tr><td bgcolor="#FCC451" scope="row">Orange



</td><td>Cells that had a commit attempted, but the commit failed due to detected
              changes from external sources. For example, a different
              user made a change to a field after it was imported into
              Excel. This is a feature of Optimistic Updates.</td></tr><tr><td bgcolor="#FFFCC7" scope="row">Yellow



</td><td>Cells that accept new data. Data entered here is inserted into the MySQL
table.</td></tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
      In our example, the green "Drama" field was changed and then
      committed first, then the blue "Gaming" field was changed but not
      committed, and then <span class="guilabel">Auto-Commit</span> was enabled
      before changing the "9" to a "10" in column 10, which generated an
      error because this commit would have added a duplicate value as
      primary key.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="mysql-for-excel-import"></a>27.3 Import MySQL Data into Excel</h2>

</div>

</div>

</div>
<p>
      Data can be imported from MySQL into a Microsoft Excel spreadsheet
      by using the <span class="guilabel">Import MySQL Data</span> option after
      selecting either a table, view, or procedure to import.
</p>
<h3><a name="idm47343733442144"></a>Choosing columns to import</h3>
<p>
      By default, all columns are selected and will be imported.
      Specific columns may be selected (or unselected) using the
      standard Microsoft Windows method of either
      <span class="keycap"><strong>Control</strong></span> + <code class="literal">Mouse click</code> to
      toggle the selection of individual columns, or
      <span class="keycap"><strong>Shift</strong></span> + <code class="literal">Mouse click</code> to select
      a range of columns.
    </p><p>
      The background color of a column shows the status of each column.
      The color white means that the column has been selected, and
      therefore it will be imported. Conversely, a gray background means
      that the column will not be imported.
    </p><p>
      Right-clicking anywhere in the preview grid opens a context-menu
      with either a <code class="literal">Select None</code> or <code class="literal">Select
      All</code> option, depending on the current status.
</p>
<h3><a name="idm47343733435600"></a>Importing a table</h3>
<p>
      The dialog while importing a table includes the following options:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <span class="guilabel">Include Column Names as Headers</span>: Enabled
          by default, this inserts the column names at the top of the
          Microsoft Excel spreadsheet as a "headers" row.
        </p></li><li class="listitem"><p>
          <span class="guilabel">Limit to ___ Rows and Start with Row ___</span>:
          Disabled by default, this limits the range of imported data.
          The <code class="literal">Limit to</code> option defaults to
          <code class="literal">1</code>, and defines the number of rows to
          import. The <code class="literal">Start with Row</code> option defaults
          to <code class="literal">1</code> (the first row), and defines where the
          import begins. Each option has a maximum value of COUNT(rows)
          in the table.
</p></li></ul>
</div>
<p>
      The <span class="guibutton">Advanced Options</span> include:
</p>
<div class="figure">
<a name="mysql-for-excel-import-advanced"></a><p class="title"><b>Figure 27.4 Importing table data with MySQL for Excel: Advanced options</b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="images/mysql-for-excel-import-advanced.png" width="550" height="359" alt="Importing table data with MySQL for Excel: Advanced options">
</div>

</div>

</div>
<br class="figure-break"><p>
      <span class="strong"><strong>General Options</strong></span>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Use the first [ ] rows to preview the MySQL tables data.
          Defaults to 10.
        </p></li><li class="listitem"><p>
          [] Escape text values that start with "=" so Excel does not
          treat them as formulas. Enabled by default.
</p></li></ul>
</div>
<p>
      <span class="strong"><strong>Excel Table Options</strong></span>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          [] Create an Excel table for the imported MySQL table data.
          Enabled by default.
        </p></li><li class="listitem"><p>
          Use style [ ] for the new Excel table. Defaults to
          <code class="literal">MySqlDefault</code>.
        </p></li><li class="listitem"><p>
          [] Prefix Excel tables with the following text: _______.
          Disabled by default.
</p></li></ul>
</div>
<p>
      Importing a table displays a dialog similar to the following:
</p>
<div class="figure">
<a name="mysql-for-excel-import-data"></a><p class="title"><b>Figure 27.5 Importing table data with MySQL for Excel</b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="images/excel-plugin-import-data.png" width="800" height="688" alt="Importing table data with MySQL for Excel">
</div>

</div>

</div>
<br class="figure-break">
<h3><a name="idm47343733404464"></a>Importing a view or procedure</h3>
<p>
      Importing a view or procedure displays a similar dialogue, but
      with the following options:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <span class="guilabel">Include Column Names as Headers</span>: Enabled
          by default, this will insert the column names at the top of
          the Excel spreadsheet as a "headers" row.
        </p></li><li class="listitem"><p>
          <span class="guilabel">Import</span>: Because a procedure might return
          multiple result sets, the import options include:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <span class="guimenu">Selected Result Set</span>: Imports the
              selected tab sheet. This is the default behavior.
            </p></li><li class="listitem"><p>
              <span class="guimenu">All Result Sets - Arranged
              Horizontally</span>: Imports all result sets into the
              Excel Worksheet horizontally, and inserts one empty column
              between each result set.
            </p></li><li class="listitem"><p>
              <span class="guimenu">All Result Sets - Arranged Vertically</span>:
              Imports all result sets into the Excel Worksheet
              vertically, and inserts one empty row between each result
              set.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
      For example, a dialogue like the following is displayed after
      importing a procedure and pressing the <span class="guibutton">Call</span>
      button to invoke the stored procedure:
</p>
<div class="figure">
<a name="mysql-for-excel-import-data-procedure"></a><p class="title"><b>Figure 27.6 Importing called stored procedure data with MySQL for Excel</b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="images/excel-plugin-import-data-procedure.png" width="800" height="614" alt="Importing called stored procedure data with MySQL for Excel">
</div>

</div>

</div>
<br class="figure-break">
</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="mysql-for-excel-append"></a>27.4 Append Excel Data into MySQL</h2>

</div>

</div>

</div>
<p>
      Data from a Microsoft Excel spreadsheet can be appended to a MySQL
      database table by using the <span class="guilabel">Append Excel MySQL Data to
      Table</span> option.
</p>
<h3><a name="idm47343733384096"></a>Column mappings</h3>
<p>
      Mapping the Excel columns to the MySQL columns can be executed
      automatically (default), manually, or by using a stored mapping
      routine. An automatic mapping routine is the default, and can be
      can be tweaked if every column cannot be matched automatically.
      The following screenshot shows two columns of Excel data, and the
      preview dialog after choosing <span class="guilabel">Append Excel Data to
      Table</span>:
</p>
<div class="figure">
<a name="mysql-for-excel-append-data-automatic"></a><p class="title"><b>Figure 27.7 Appending Excel data to MySQL (Automatic mapping)</b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="images/mysql-for-excel-append-data-automatic.png" width="800" height="792" alt="Appending Excel data to MySQL (Automatic mapping)">
</div>

</div>

</div>
<br class="figure-break">
<h3><a name="idm47343733375136"></a>General mapping information</h3>
<p>
      It is common to tweak the column mappings. A few notes about the
      manual mapping process:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Manual mapping is performed by dragging a column from the
          upper source grid (Excel spreadsheet) and dropping it into the
          lower target column MySQL table grid. Click anywhere within
          the column to initiate this dragging routine.
        </p></li><li class="listitem"><p>
          The color of the header field for each column defines the
          current mapping status of the column. The colors include:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Green: A source column is mapped to a target column.
            </p></li><li class="listitem"><p>
              Red: A target column is not mapped.
            </p></li><li class="listitem"><p>
              Gray: A source column is not mapped.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          A source column may be mapped to multiple target columns,
          although this action generates a warning dialog.
        </p></li><li class="listitem"><p>
          Right-clicking a target column shows a context menu with
          options to either <span class="guimenu">Remove Column Mapping</span> for
          a single column, or to <span class="guimenu">Clear All Mappings</span>
          for all columns. Dragging a target column outside of the grid
          removes the mapping.
</p></li></ul>
</div>
<h3><a name="idm47343733365520"></a>Mapping methods</h3>
<p>
      The three mapping methods are described below:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <span class="guilabel">Automatic</span>: The automatic mapping method
          attempts to match the Excel source column names with the MySQL
          target table column names. It is then possible to manually
          tweak the mapping afterwards.
        </p><p>
          If the automatic process finds zero columns to match, then a
          simple 1 to 1 matching routine is attempted. Meaning,
          SourceColumn #1 to TargetColumn #1, SourceColumn #2 to
          TargetColumn #2, and so on.
        </p></li><li class="listitem"><p>
          <span class="guilabel">Manual</span>: The source column names are
          manually dragged (matched) with the target column names.
          Manual dragging can also be performed after the
          <span class="guilabel">Automatic</span> method is selected.
        </p></li><li class="listitem"><p>
          <span class="guilabel">Stored</span>: Manual mapping styles may be
          saved using the <span class="guibutton">Store Mapping</span> button,
          which will also prompt for a name and then save it using a
          "<em class="replaceable"><code>name</code></em> (dbname.tablename)" naming
          scheme. The saved mapping style will then be available
          alongside the <span class="guilabel">Automatic</span> and
          <span class="guilabel">Manual</span> options.
        </p><p>
          Stored mappings may be deleted or renamed within the
          <span class="guibutton">Advanced Options</span> dialog.
</p></li></ul>
</div>
<h3><a name="idm47343733354032"></a>Advanced Options</h3>
<p>
      There are several advanced options that are configured and stored
      between sessions for each Excel user. The dialog looks similar to:
</p>
<div class="figure">
<a name="mysql-for-excel-append-data-advanced"></a><p class="title"><b>Figure 27.8 Appending Excel data to MySQL (Advanced Options)</b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="images/mysql-for-excel-append-data-advanced.png" width="490" height="614" alt="Appending Excel data to MySQL (Advanced Options)">
</div>

</div>

</div>
<br class="figure-break"><p>
      The advanced <span class="guilabel">Mapping Options</span>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">Perform an automatic mapping when dialog
          opens</code>: Automatically attempt to map the target and
          source when the <span class="guilabel">Append Data</span> dialog is
          opened. This feature is enabled by default.
        </p></li><li class="listitem"><p>
          <code class="literal">Automatically store the column mapping for the given
          table</code>: Stores each mapping routine after executing
          the <span class="guibutton">Append</span> operation. The mapping
          routine is saved using the "tablenameMapping
          (dbname.tablename)" format. This may also be performed
          manually using the <span class="guibutton">Store Mapping</span>
          button. It is enabled by default, and this feature was added
          in MySQL for Excel 1.1.0.
        </p></li><li class="listitem"><p>
          <code class="literal">Reload stored column mapping for the selected table
          automatically</code>: If a stored mapping routine exists
          that matches all column names in the source grid with the
          target grid, then it is automatically be loaded. This is
          enabled by default, and this feature was added in MySQL for Excel
          1.1.0.
</p></li></ul>
</div>
<p>
      The advanced <span class="guilabel">Field Data Options</span>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <span class="guilabel">Use the first</span>
          <em class="replaceable"><code>100</code></em> (default) Excel data rows to
          preview and calculate data types. This determines the number
          of rows that the preview displays, and the values that affect
          the automatic mapping feature.
        </p></li><li class="listitem"><p>
          <span class="guilabel">Use formatted values</span>: The data from Excel
          is treated as <code class="literal">Text</code>,
          <code class="literal">Double</code>, or <code class="literal">Date</code>. This is
          enabled by default. When disabled, data is never treated as a
          <code class="literal">Date</code> type, so for example, this means that
          a date would be represented as a number.
</p></li></ul>
</div>
<p>
      The advanced <span class="guilabel">SQL Queries Options</span>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">Disable table indexes to speed-up rows
          insertion</code>: This option is disabled by default, since
          you must make sure that if unique indexes are present, that
          the data mapped to that column does not contain duplicate
          data. This option was added in MySQL for Excel 1.2.1.
</p></li></ul>
</div>
<p>
      The <span class="guilabel">Stored Column Mappings</span> is a list of saved
      column mappings that were saved with the "Automatically store the
      column mapping for the given table" feature, or manually with the
      <span class="guibutton">Store Mapping</span> option.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="mysql-for-excel-export"></a>27.5 Export Excel Data into MySQL</h2>

</div>

</div>

</div>
<p>
      Data from a Microsoft Excel spreadsheet can be exported to a new
      MySQL database table by using the <span class="guilabel">Export Excel Data to
      New Table</span> option. Exporting data looks like so:
</p>
<div class="figure">
<a name="mysql-for-excel-export-figure"></a><p class="title"><b>Figure 27.9 Exporting Excel data to MySQL</b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="images/mysql-for-excel-export.png" width="800" height="688" alt="Exporting Excel data to MySQL">
</div>

</div>

</div>
<br class="figure-break">
<h3><a name="idm47343733314400"></a>Advanced Export options</h3>
<p>
      Several advanced options enables you to tweak the exported data.
      The advanced options dialog looks like so:
</p>
<div class="figure">
<a name="mysql-for-excel-export-advanced"></a><p class="title"><b>Figure 27.10 Exporting Excel data to MySQL (Advanced options)</b></p>
<div class="figure-contents">

<div class="mediaobject">
<img src="images/mysql-for-excel-export-advanced.png" width="590" height="445" alt="Exporting Excel data to MySQL (Advanced options)">
</div>

</div>

</div>
<br class="figure-break">
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <span class="guilabel">Column Datatype Options</span>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Use the first <em class="replaceable"><code>100</code></em> (default)
              Excel data rows to preview and calculate data types: This
              determines the number of rows that the preview displays,
              and the values that affect the automatic mapping feature.
            </p></li><li class="listitem"><p>
              Analyze and try to detect correct datatype based on column
              field contents: Attempts to analyze the data and determine
              the data type for the column. The column type is defined
              as <code class="literal">VARCHAR</code> if it contains multiple
              types.
            </p></li><li class="listitem"><p>
              Add additional buffer to <code class="literal">VARCHAR</code> length
              (round up to 12, 25, 45, 125, 255): When the data type is
              automatically detected and is set to
              <code class="literal">VARCHAR</code>, then it calculates the maximum
              length for all rows within the column, and rounds up the
              maximum length to one of the defined lengths above.
            </p><p>
              If disabled, then the <code class="literal">VARCHAR</code> length is
              set to the length of the longest entry in the Excel
              spreadsheet.
            </p></li><li class="listitem"><p>
              Automatically check the Index checkbox for Integer
              columns: If enabled (default), columns with an Integer
              data type will have the <span class="guilabel">Create Index</span>
              option enabled by default.
            </p></li><li class="listitem"><p>
              Automatically check the Allow Empty checkbox for columns
              without an index: If enabled (default), columns without
              the <span class="guilabel">Create Index</span> checkbox checked
              will automatically enable the <span class="guilabel">Allow
              Empty</span> configuration option.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <span class="guilabel">Field Data options</span>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Use formatted values: When enabled (default), the data
              from Excel is treated as <code class="literal">Text</code>,
              <code class="literal">Double</code>, or <code class="literal">Date</code>.
              When disabled, data is never treated as a
              <code class="literal">Date</code> type, so for example this means
              that a date would be represented as a number.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <span class="guilabel">Other options</span>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Create table's secondary indexes after data has been
              exported to speed-up rows insertion: This saves disk I/O
              for bulk inserts (thousands of rows) since reindexing will
              not happen every time a row is inserted, but only once at
              the end of the data insertion. This option is enabled by
              default, and was added in MySQL for Excel 1.2.1.
            </p></li><li class="listitem"><p>
              Note: This option was <code class="literal">Removed</code> in
              MySQL for Excel 1.2.1. Now, the default behavior is to always
              remove empty columns from the calculations.
            </p><p>
              Remove columns that contain no data, otherwise flag them
              as "Excluded": If enabled, columns without data in Excel
              are removed and not shown in the preview panel. If
              disabled (default), these columns will exist but have the
              <span class="guilabel">Exclude Column</span> option checked. This
              option was added in MySQL for Excel 1.1.0.
</p></li></ul>
</div>
</li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="mysql-for-excel-what-is-new"></a>27.6 What Is New In MySQL for Excel</h2>

</div>

</div>

</div>
<h3><a name="idm47343733279856"></a>Version 1.2.0</h3>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">Edit Connections</code>: MySQL connections can now
          be edited from within the MySQL for Excel plugin by right-clicking
          and choosing <span class="guilabel">Edit Connection</span>. Before,
          these connections could only be edited with MySQL Workbench.
        </p></li><li class="listitem"><p>
          <code class="literal">Optimistic Updates</code>: Previously, only
          "Pessimistic Updates" were used, which means that pressing
          <span class="guilabel">Commit Changes</span> would overwrite changes
          performed outside of MySQL for Excel for the edited cells.
        </p><p>
          Both options remain available today, and optimistic updates
          are enabled by default. This update type can be set either as
          a preference, or toggled per session.
        </p></li><li class="listitem"><p>
          The <span class="guilabel">Append Data</span> dialog will now notify
          you of incompatible types (with visual warnings) when mapping
          source Excel columns to target MySQL columns.
        </p><p>
          If a mismatch is discovered, then the column in the source
          grid that contains the mapped Excel data turns red, and
          selecting this column displays a warning with text explaining
          that the source data is not suitable for the mapped target
          column's data type.
        </p></li><li class="listitem"><p>
          New preview preferences allow you to enable one of the
          following three options:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <span class="guilabel">Preview SQL statements before they are sent to
              the Server</span>: View (and optionally) edit the
              MySQL UPDATE/INSERT statements before they are committed.
            </p></li><li class="listitem"><p>
              <span class="guilabel">Show executed SQL statements along with the
              results</span>: View the statements after they are
              committed, which is the current behavior.
            </p></li><li class="listitem"><p>
              <span class="guilabel">Do not show the MySQL statements</span>:
              Only show summary information, such as number of affected
              rows, and not MySQL statements. This is enabled by
              default.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          Create Table: The <span class="guilabel">Data Export</span> feature now
          has the option to only create the table without inserting the
          data.
        </p><p>
          To execute, toggle the <span class="guibutton">Export Data</span>
          button to <span class="guibutton">Create Table</span>, and then click.
        </p></li><li class="listitem"><p>
          The selected schema name is now displayed on top of the
          MySQL for Excel Database Object Selection panel.
        </p></li><li class="listitem"><p>
          The <span class="guilabel">Advanced Options</span> dialogs opened from
          the Import, Export and Append Data windows now immediately
          apply the option changes, when before the <span class="guilabel">Advanced
          Options</span> dialog had to be reopened before the
          changes could be previewed.
        </p></li><li class="listitem"><p>
          <span class="guilabel">Edit Data</span> sessions can now be saved:
          Using the new <span class="guilabel">Edit Session</span> preferences,
          these sessions were automatically closed after closing an
          Excel workbook. This data, such as the Workbench connection
          ID, MySQL schema, and MySQL table name, can now be preserved
          if the Excel workbook is saved to disk, and available when the
          Excel workbook is reopened.
        </p></li><li class="listitem"><p>
          Excel tables are automatically created for any data imported
          from MySQL to an Excel worksheet, with a name like
          "Schema.DB-Object-name". The DB object name can be a MySQL
          table, view, or stored procedure. Options for this feature are
          listed under <span class="guilabel">Import Data</span>,
          <span class="guilabel">Advanced Options</span>. The newly created Excel
          tables can be referenced for data analysis in Pivot Tables or
          reports.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="mysql-for-excel-faq"></a>27.7 MySQL for Excel FAQ</h2>

</div>

</div>

</div>
<p>
      Frequently Asked Questions, with Answers.
</p><p><span class="bold"><strong>Questions</strong></span></p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a class="link" href="mysql-for-excel.html#qandaitem-28-7-1-1">28.7.1: </a>
            I installed the MySQL for Excel plugin, but can't find it in
            Microsoft Excel. How do I start it?
          </p></li><li class="listitem"><p><a class="link" href="mysql-for-excel.html#qandaitem-28-7-1-2">28.7.2: </a>
            I click on <span class="guilabel">Edit Data</span> and after
            importing the table data into Excel, I can't sort or move
            columns around. How can I do that?
          </p></li><li class="listitem"><p><a class="link" href="mysql-for-excel.html#qandaitem-28-7-1-3">28.7.3: </a>
            When editing a MySQL table's data, the Excel worksheet where
            the data is dumped is protected. How can unprotect it?
          </p></li><li class="listitem"><p><a class="link" href="mysql-for-excel.html#qandaitem-28-7-1-4">28.7.4: </a>
            The MySQL Workbench connections that use SSH tunneling appear
            grayed out (disabled) in MySQL for Excel. How can I use a SSH
            connection?
</p></li></ul>
</div>
<p><span class="bold"><strong>Questions and Answers</strong></span></p><p><a name="qandaitem-28-7-1-1"></a><span class="bold"><strong>28.7.1: </strong></span><span class="bold"><strong>
            I installed the MySQL for Excel plugin, but can't find it in
            Microsoft Excel. How do I start it?
          </strong></span></p><p>
            The MySQL for Excel plugin is automatically added to Microsoft
            Excel's data menu when it is installed. Look for the
            MySQL for Excel icon, by default it will be listed on the right
            side of the main menu.
          </p><p>
            If it's not there, then you might have to reinstall the
            plugin. But before doing so, first check if it's listed
            under "Add/Remove Programs" in Microsoft Windows. If not,
            then it has not been installed. Next, check the Excel
            Add-Ins list. For Office 2007 this is found by clicking the
            Office logo in Excel (top left corner), click
            <span class="guibutton">Excel Options</span>, then select
            <span class="guilabel">Add-Ins</span>. Is MySQL for Excel listed as a COM
            Add-in? If so, then consider filing a bug report
            (bugs.mysql.com), or attempt to reinstall the plugin.
          </p><p><a name="qandaitem-28-7-1-2"></a><span class="bold"><strong>28.7.2: </strong></span><span class="bold"><strong>
            I click on <span class="guilabel">Edit Data</span> and after
            importing the table data into Excel, I can't sort or move
            columns around. How can I do that?
          </strong></span></p><p>
            In order to maintain the mapping of rows and columns in the
            Excel Worksheet against the rows and columns in the MySQL
            table, no alteration is permitted on the worksheet (i.e.
            sorting, deleting rows, deleting columns). If you need to
            alter the data there you can do that by right-clicking the
            <span class="guilabel">Edit Data</span> window and selecting
            <span class="guilabel">Exit Edit Mode</span>.
          </p><p><a name="qandaitem-28-7-1-3"></a><span class="bold"><strong>28.7.3: </strong></span><span class="bold"><strong>
            When editing a MySQL table's data, the Excel worksheet where
            the data is dumped is protected. How can unprotect it?
          </strong></span></p><p>
            The Excel worksheet is protected to not allow alterations to
            the order of rows and columns. The password used for the
            protection is a GUID auto-generated at runtime so that the
            protection is not violated in any way. If you wish to
            unprotect the worksheet to manipulate your data, you can do
            that by right-clicking the <span class="guilabel">Edit Data</span>
            window and selecting <span class="guilabel">Exit Edit Mode</span>.
          </p><p><a name="qandaitem-28-7-1-4"></a><span class="bold"><strong>28.7.4: </strong></span><span class="bold"><strong>
            The MySQL Workbench connections that use SSH tunneling appear
            grayed out (disabled) in MySQL for Excel. How can I use a SSH
            connection?
          </strong></span></p><p>
            This is a known limitation of MySQL for Excel. MySQL for Excel uses MySQL
            Connector/NET to connect and communicate with MySQL
            databases. Connector/NET does not have SSH support, so the
            behavior will change if Connector/NET supports it in the
            future.
</p>
</div>

</div>
<div class="copyright-footer">
<p>
    Copyright © 1997, 2014, Oracle and/or its affiliates. All
    rights reserved.
<a href="preface.html#legalnotice">Legal Notices</a></p>
</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left"><a accesskey="p" href="workbench.html">Prev</a></td>
<td width="20%" align="center"><a accesskey="u" href="">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="licenses-third-party.html">Next</a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Chapter 26 MySQL Workbench</td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top">Appendix A Licenses for Third-Party Components</td>
</tr>
</table>
</div>
</body>
</html>
