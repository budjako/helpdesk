define(["events","js!"+z.mootoolsUrl],function(e){function o(e,t,n,r){f().pathname=="/web-development-tools"&&curl(t,n),r&&n()}function u(e){var t=f();return e.replace(t.protocol+"//"+t.host,"")}function a(){return $(z.d.body)}function f(){return z.w.location}function l(e,t,n){var r;return function(){var i=this,s=arguments;clearTimeout(r),r=setTimeout(function(){r=null,n||e.apply(i,s)},t),n&&!r&&e.apply(i,s)}}var t,n,r,i,s;z.isDebug&&localStorage.clear()&&sessionStorage.clear(),t="keyup",n="click",r="/page/ready",i=z.ajaxPageLoads,a().addEvent(n+":relay(.dropdown a)",function(e,t){var n=t.getParent(".dropdown"),r="display";n.setStyle(r,"none"),setTimeout(function(){n.setStyle(r,"")},1e3)}),curl(["social"],function(t){function n(){setTimeout(function(){t.reload()},300)}n(),i&&e.subscribe(r,n)}),z.loadStats&&curl(["analytics"],function(t){function s(e){a().addEvent(n+":relay("+e+")",function(e,n){t.trackEvent("feature",n.href)})}var r=function(){t.trackPageView()};i&&e.subscribe("/page/loaded",r),i&&e.subscribe("/page/democlosed",r),s("a.feature","feature"),s("a.nextPrevLink","nextprev"),s(".related a","related"),s(".dropdown a","menu")}),z.loadAds&&curl(["ads"],function(t){e.subscribe(r,function(){t.reload()}),t.reload()}),curl(["syntax"],function(t){t.highlightPost(),e.subscribe("comments/added",function(e){t.highlightComments("li[data-comment="+e.li.get("data-comment")+"]")}),i&&e.subscribe(r,t.highlightPost),t.highlightForums(),i&&e.subscribe(r,t.highlightForums)}),z.loadSearch&&curl(["search"],function(e){var n=$("q");n.addEvent("focus",function(){e.input=n,n.addEvent(t,l(function(t){n.value&&e.search(t)},500))})}),curl(["comments","syntax"],function(t,i){e.subscribe("/comments/added",function(){$$(".noCommentsText").setStyle("display","none")}),t.setReplyLinks(),e.subscribe(r,function(){t.setReplyLinks()}),a().addEvent("submit:relay(#cForm)",function(e,n){e.stop(),t.submitForm(n)}),a().addEvent("keydown:relay(#comment)",function(e){e.code==9&&(e.preventDefault(),$$("#commentForm input[name=submit]")[0].focus())}),e.subscribe(r,function(){t.setAvatars(),i.highlightComments()}),t.setAvatars(),e.publish("comments/loaded"),i.highlightComments(),a().addEvent(n+":relay(#commentUseEditor)",function(e,n){t.createEditor($("comment"),n)}),e.subscribe(r,function(){t.aceSession=null})}),z.loadSidebar&&curl(["storage","ads"],function(e,t){function i(e){var n=(new Element("div",{html:e})).getFirst(".right");n.inject($$("section.left")[0],"after"),n.addClass("fadeIn"),t.reload(n),setTimeout(function(){n.setStyle("opacity",1).removeClass("fadeIn")},350)}var n,r;n="sidebar",r=e.get(n),r?i(r):curl(["text!"+z.themePath+n+".php"],function(t){i(t),e.set(n,t,z.sidebarCacheMinutes)})}),curl(["js!lib/mootools-more/Fx.Scroll.js"],function(){function l(){function e(e){e.addClass("focused"),i.toElement(e)}if(n)return;n=1,i=new Fx.Scroll(z.w,{onComplete:function(){$$(f)[0].getFirst("."+s+" h2 a, ."+s+" h1 a, .ad a").focus()}}),a().addEvent(t,function(t){var n,r,i,a,l,c=t.code;targetTag=t.target.tagName;if(!c||c!=o&&c!=u)return;if(targetTag=="TEXTAREA"||targetTag=="INPUT"||targetTag=="SELECT")return;n=$$(f);if(!n.length)return;n=n[0],n.addClass("focusable"),r=n.getChildren(),i=n.getFirst("."+s),a=i&&i.getNext(),l=i&&i.getPrevious(),c==o&&l?i&&l&&(t.stop(),i.removeClass(s),e(l)):c==u&&(i&&a?(t.stop(),i.removeClass(s),e(a)):i||(t.stop(),e(n.getFirst())))})}function c(){$$(f).length&&l()}var n,i,s="focused",o=38,u=40,f=".postList";c(),e.subscribe(r,function(){currentFocus=-1,c()})}),i&&curl(["js!lib/mootools-history/Source/History.js","js!lib/mootools-more/Fx.Scroll.js"],function(){function g(e){var t,n,r,i="CONTENT",s={postContent:e.substring(e.indexOf("<!--"+i+"-->"),e.indexOf("<!--/"+i+"-->")),title:e.match(/<title>(.*)<\/title>/)[1]};return s.title&&(s.title=s.title.replace("Topic: ","")),t=e.match(/body class="(.*)"/),s.classes=t&&t[1]?t[1]:"",n=e.match(/<link rel="canonical" href="(.*)"/),r=f()+"",s.canonical=n&&n.length>1?n[1]:r,s.classes.indexOf("cacheable")!=-1&&(m[u(r)]=e),s}function y(){var e=f().hash.replace("#",""),t=$$("#"+e+", a[name="+e+"]");return e&&t.length?t[0]:0}function b(){a().addClass(l)}function w(){a().removeClass(l)}function E(t){function f(e){i||(i=new Fx.Scroll(z.w,{duration:z.isMobile?10:350,onComplete:function(){if(e!=$("top"))try{e.focus()}catch(t){}}})),i.toElement(e)}var n,u;if(a().hasClass("demo"))return e.publish("/page/democlosed"),o!=undefined&&setTimeout(function(){z.w.scrollTo(0,o);try{s&&s.focus()}catch(e){}},50),a().removeClass("demo");e.publish("/page/loaded"),n=g(t),a().className=n.classes,$$("section.left").set("html",n.postContent),z.d.title=n.title,$$("link[rel=canonical]").set("href",n.canonical),f(y()||$("top")),e.publish(r),u=z.w.CodePenEmbed,u&&u.init()}var i,s,o,l,c,h,p,d,v,m={};g(z.d.documentElement.innerHTML),a().addEvent(n+":relay(a:not([href=#],[href=javascript:;],[data-noxhr]))",function(e,t){var n,r,i;s=e.target,o=window.scrollY;if(e.meta||e.control||e.event.which==2||t.href.indexOf(window.location.hostname)==-1)return;n=t.href,r=f(),i=r+"";if(n.indexOf(r.host)==-1||n.split("#")[0]==i.split("#")[0]||t.hasClass("post-edit-link")||t.get("target"))return;e.stop(),History.push(n)}),l="working pageLoading",c=new Request({method:"get",timeout:1e4,link:"cancel",onRequest:b,onSuccess:E,evalScripts:!0,onFailure:function(){window.location=window.location+""},onComplete:w}),h="demo",History.addEvent("change",function(e){var e,t,n,r,i,s,o;c.cancel(),t=y();if(!z.d.body.hasClass("demo")&&t)return;e=function(){var t=f();return e.indexOf("http")==-1&&(e=t.protocol+"//"+t.host+e),e}();if(e.indexOf("/"+h+"/")!=-1){if(z.isMobile){window.location=e;return}d||(n="$$('."+h+"Iframe').setStyle('display', 'none').destroy();History.back();return false;",d=(new Element("div",{"class":h+"Box",html:'<div class="'+h+'Toolbar"> 									<span class="intro">Demo for: 										<a href="javascript:;" onclick="'+n+'"></a> 									</span> 									<a href="javascript:;" class="close data-noxhr" onclick="'+n+'">Close</a>							   </div><div class="'+h+'IframeHolder"></div>'})).inject(a())),v=(new IFrame({src:e,frameborder:0,"class":h+"Iframe",events:{load:function(){try{v.contentWindow.document.documentElement.className="demoFrame"}catch(e){}}}})).inject(d.getFirst("."+h+"IframeHolder")),p=d.getElements(".intro a")[0],v.addClass("fadeIn"),v.src=e+"?",r=f(),i=$$("a[href="+e+"]"),s=$$("h1, h2")[0].innerHTML,i.length&&(o=i[0].getParent("li"),o&&(s=o.getFirst("h2 a").innerHTML)),p.set("html",s),a().addClass(h)}else m[u(e)]?(b(),w(),E(m[u(e)])):(c.url=e,c.send())}),function(){function s(){function s(t,n,r){if(t==n&&r){r.hasClass(i)?History.push(r.href):(r.addClass(i),e=setTimeout(function(){r&&r.removeClass(i)},5e3));return}}a().addEvent(t,function(e){var t=e.code,i=e.target.tagName;if(i=="TEXTAREA"||i=="INPUT")return;$$(".nextPrevLink").length&&(s(t,n,$("prevLink")),s(t,r,$("nextLink")))})}var e,n=37,r=39,i="showFull";s()}(),z.d.documentElement.className+=" history",a().addEvent(n+":relay(.kwicks li > div)",function(e,t){$(e.target).get("tag")!="a"&&History.push(t.get("data-href"))});if(!z.isMobile&&!Browser.ie){function S(){var e,t="explode";f().pathname=="/"&&(e=$$("."+t))&&e.length&&curl([t],function(t){t(e,12,12)})}S(),e.subscribe(r,S)}}),!z.isMobile&&o("/web-development-tools",["dev-tools"],function(e){z.tools=e},1),o("/deals",null,function(){var e;s||(a().addEvent(n+":relay(.dealList li)",function(e,t){window.location=t.get("data-url")}),s=1),e=z.w.BundleHunt,e&&e.init()},1),function(){var e=$$("header .headerTitle")[0];(new Element("a",{html:"<strong>Follow David Walsh Blog on Facebook</strong>","class":"catty",href:"https://www.facebook.com/davidwalshblog"})).inject(e)}(),(new Element("div",{id:"indicator"})).inject(a()),a().addEvent(n+":relay(.sexyRelated)",function(e,t){t.getParent().getElements(".relatedSns").toggleClass("show")}),curl(["forums"])});